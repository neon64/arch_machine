pkgname=thinkpad-x1e-config
pkgver=0.1
pkgrel=2

pkgdesc='personal system configuration for Lenovo Thinkpad X1 Extreme'
arch=('any')
url='https://github.com/neon64/arch_machine'
license=('MIT')
source=("etc-issue-template")
install="thinkpad-x1e-config.install"
depends=(
    'tlp' # power management
    'ethtool' # disable wake-on-LAN
    'acpi_call' # ThinkPad battery functions
    'x86_energy_perf_policy' # set power vs. performance policy
    'bbswitch'
    'netctl' # internet access
    'pulseaudio' # audio setup
    'base-config'
)

# https://github.com/Earnestly/pkgbuilds/blob/master/system-config/PKGBUILD

build() {
    env TERM="linux" bash ~/.config/colors/base16-shell/scripts/base16-material-darker.sh > etc-issue
    echo -e "" >> etc-issue
    cat etc-issue-template >> etc-issue
}

package() {
    install -Dm0644 "../etc/default/tlp" "$pkgdir/etc/default/tlp"
    install -Dm0644 "../etc/intel-undervolt.conf" "$pkgdir/etc/intel-undervolt.conf"
    install -Dm0644 "../etc/modprobe.d/bbswitch.conf" "$pkgdir/etc/modprobe.d/bbswitch.conf"
    install -Dm0644 "../etc/modprobe.d/no-beep.conf" "$pkgdir/etc/modprobe.d/no-beep.conf"
    install -Dm0644 "../etc/modprobe.d/no-camera.conf" "$pkgdir/etc/modprobe.d/no-camera.conf"
    install -Dm0644 "../etc/modprobe.d/blacklist-nouveau.conf" "$pkgdir/etc/modprobe.d/blacklist-nouveau.conf"
    install -Dm0644 "../etc/modules-load.d/bbswitch.conf" "$pkgdir/etc/modules-load.d/bbswitch.conf"
    install -Dm0644 "../etc/sysctl.d/99-swap.conf" "$pkgdir/etc/sysctl.d/99-swap.conf"
    install -Dm0644 "../etc/netctl/enp0s3" "$pkgdir/etc/netctl/enp0s3"
    install -Dm0644 "../etc/hosts" "$pkgdir/etc/hosts"
    install -Dm0644 etc-issue "$pkgdir/etc/issue"
    install -Dm0644 "../etc/hostname" "$pkgdir/etc/hostname"
    install -Dm0644 "../etc/mkinitcpio.conf" "$pkgdir/etc/mkinitcpio.conf"
}
md5sums=('56a57c1211c7a4f27e3020b82de486fd')
